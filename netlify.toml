# Netlify 核心配置（HTML 放根目录）
[build]
  # 关键修改：publish 改为根目录（. 代表当前根目录）
  publish = "."
  # 静态页面无需构建，执行空命令
  command = "echo 'No build needed'"

# 解决邮箱接口跨域（核心：代理 API 请求）
[[redirects]]
  from = "/api/wx_mail/send"
  to = "https://api.ruojy.top/api/wx_mail/send"
  method = ["POST", "OPTIONS"]  # 包含 OPTIONS 预检请求
  status = 200
  force = true
  # 允许跨域的响应头（必须配置）
  [redirects.headers]
    Access-Control-Allow-Origin = "*"
    Access-Control-Allow-Headers = "accept, token, Content-Type"
    Access-Control-Allow-Methods = "POST, OPTIONS"

# （可选）支持 /admin 路径直接访问管理员后台（避免 404）
[[redirects]]
  from = "/admin"
  to = "/"
  status = 200
  force = true

# （可选）解决单页应用刷新 404 问题
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
